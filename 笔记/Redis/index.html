<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis学习 | YuanYE</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/blog/logo.png">
    <meta name="description" content="Kori Lin BLOG">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" conetent="KORILIN">
    <meta name="twitter:creator" conetent="@Kori_Lin">
    
    <link rel="preload" href="/blog/assets/css/1.styles.1f37ec6d.css" as="style"><link rel="preload" href="/blog/assets/js/app.3aaa0c49.js" as="script"><link rel="preload" href="/blog/assets/js/11.05829631.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.73419e87.js"><link rel="prefetch" href="/blog/assets/js/12.7e8086c5.js"><link rel="prefetch" href="/blog/assets/js/13.f1400667.js"><link rel="prefetch" href="/blog/assets/js/14.c6dd0951.js"><link rel="prefetch" href="/blog/assets/js/15.0f37c6f6.js"><link rel="prefetch" href="/blog/assets/js/16.a4662ec0.js"><link rel="prefetch" href="/blog/assets/js/17.e8372a64.js"><link rel="prefetch" href="/blog/assets/js/18.37715e79.js"><link rel="prefetch" href="/blog/assets/js/19.e397b51f.js"><link rel="prefetch" href="/blog/assets/js/2.1e961ff5.js"><link rel="prefetch" href="/blog/assets/js/20.19f61b49.js"><link rel="prefetch" href="/blog/assets/js/21.3b043514.js"><link rel="prefetch" href="/blog/assets/js/22.60b4227d.js"><link rel="prefetch" href="/blog/assets/js/23.0dbcd6f8.js"><link rel="prefetch" href="/blog/assets/js/24.b5bb6a2c.js"><link rel="prefetch" href="/blog/assets/js/25.f36cd997.js"><link rel="prefetch" href="/blog/assets/js/26.2173183c.js"><link rel="prefetch" href="/blog/assets/js/27.7e05cc7c.js"><link rel="prefetch" href="/blog/assets/js/28.bcba955e.js"><link rel="prefetch" href="/blog/assets/js/29.f0b4c45b.js"><link rel="prefetch" href="/blog/assets/js/3.58551e39.js"><link rel="prefetch" href="/blog/assets/js/30.04c3ed65.js"><link rel="prefetch" href="/blog/assets/js/4.bf1654a3.js"><link rel="prefetch" href="/blog/assets/js/5.cb45b255.js"><link rel="prefetch" href="/blog/assets/js/6.aa9fd703.js"><link rel="prefetch" href="/blog/assets/js/7.a807b0d2.js"><link rel="prefetch" href="/blog/assets/js/8.29c46423.js"><link rel="prefetch" href="/blog/assets/js/9.58f55c6f.js">
    <link rel="stylesheet" href="/blog/assets/css/1.styles.1f37ec6d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><span><div id="sidebar" data-v-6e67c360><div class="PC-sidebar" data-v-6e67c360><div class="title" data-v-6e67c360>
            @<span data-v-6e67c360>YuanYE</span></div> <a href="/blog/" class="router-link-active bar-button" data-v-7201a518 data-v-6e67c360><div class="svg" data-v-7201a518><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home" data-v-7201a518><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" data-v-7201a518></path> <polyline points="9 22 9 12 15 12 15 22" data-v-7201a518></polyline></svg> <!----> <!----></div> <div class="name" data-v-7201a518>Home</div></a> <a href="/blog/archive" class="bar-button" data-v-7201a518 data-v-6e67c360><div class="svg" data-v-7201a518><!----> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-book" data-v-7201a518><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" data-v-7201a518></path> <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" data-v-7201a518></path></svg> <!----></div> <div class="name" data-v-7201a518>Archive</div></a> <a href="/blog/about/" class="bar-button" data-v-7201a518 data-v-6e67c360><div class="svg" data-v-7201a518><!----> <!----> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user" data-v-7201a518><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" data-v-7201a518></path> <circle cx="12" cy="7" r="4" data-v-7201a518></circle></svg></div> <div class="name" data-v-7201a518>About</div></a></div> <!----></div><div class="main"><div class="wrap" data-v-5d573f62><div class="post" data-v-5d573f62><div class="title" data-v-5d573f62><h1 data-v-5d573f62>Redis学习</h1></div> <div class="info" data-v-5d573f62><div class="date" data-v-382026d3 data-v-5d573f62><div class="svg" data-v-382026d3><svg t="1610177893433" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5858" width="16" height="16" class="icon" data-v-382026d3><path d="M512 192c179.2 0 320 140.8 320 320s-140.8 320-320 320-320-140.8-320-320S332.8 192 512 192M512 128C300.8 128 128 300.8 128 512s172.8 384 384 384 384-172.8 384-384S723.2 128 512 128L512 128z" p-id="5859" fill="#707070" data-v-382026d3></path> <path d="M640 672c-6.4 0-19.2 0-25.6-6.4l-128-128C486.4 531.2 480 518.4 480 512L480 288C480 268.8 492.8 256 512 256s32 12.8 32 32l0 211.2 121.6 121.6c12.8 12.8 12.8 32 0 44.8C659.2 672 646.4 672 640 672z" p-id="5860" fill="#707070" data-v-382026d3></path></svg></div> <div class="content" data-v-382026d3>2020-11-19</div></div> <div class="category" data-v-a6fce850 data-v-5d573f62><div class="svg" data-v-a6fce850><svg t="1610177808699" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4460" width="16" height="16" class="icon" data-v-a6fce850><path d="M725.290667 725.290667m-213.333334 0a213.333333 213.333333 0 1 0 426.666667 0 213.333333 213.333333 0 1 0-426.666667 0Z" p-id="4461" fill="#707070" data-v-a6fce850></path> <path d="M789.205333 234.794667m-149.333333 0a149.333333 149.333333 0 1 0 298.666667 0 149.333333 149.333333 0 1 0-298.666667 0Z" p-id="4462" fill="#707070" data-v-a6fce850></path> <path d="M235.861333 788.138667m-149.333333 0a149.333333 149.333333 0 1 0 298.666667 0 149.333333 149.333333 0 1 0-298.666667 0Z" p-id="4463" fill="#707070" data-v-a6fce850></path> <path d="M298.709333 298.709333m-213.333333 0a213.333333 213.333333 0 1 0 426.666667 0 213.333333 213.333333 0 1 0-426.666667 0Z" p-id="4464" fill="#707070" data-v-a6fce850></path></svg></div> <div class="content" data-v-a6fce850>笔记</div></div> <div class="tags" data-v-2ed44237 data-v-5d573f62><div class="svg" data-v-2ed44237><svg t="1610177743508" viewBox="0 0 1085 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2934" width="16" height="16" class="icon" data-v-2ed44237><path d="M256 256q0-30.285714-21.428571-51.714286T182.857143 182.857143t-51.714286 21.428571T109.714286 256t21.428571 51.714286T182.857143 329.142857t51.714286-21.428571T256 256z m609.714286 329.142857q0 30.285714-21.142857 51.428572l-280.571429 281.142857q-22.285714 21.142857-52 21.142857-30.285714 0-51.428571-21.142857L52 508.571429q-21.714286-21.142857-36.857143-57.714286T0 384V146.285714q0-29.714286 21.714286-51.428571t51.428571-21.714286h237.714286q30.285714 0 66.857143 15.142857T436 125.142857l408.571429 408q21.142857 22.285714 21.142857 52z m219.428571 0q0 30.285714-21.142857 51.428572l-280.571429 281.142857q-22.285714 21.142857-52 21.142857-20.571429 0-33.714285-8t-30.285715-25.714286l268.571429-268.571428q21.142857-21.142857 21.142857-51.428572 0-29.714286-21.142857-52L527.428571 125.142857q-21.714286-21.714286-58.285714-36.857143T402.285714 73.142857h128q30.285714 0 66.857143 15.142857t58.285714 36.857143l408.571429 408q21.142857 22.285714 21.142857 52z" p-id="2935" fill="#8a8a8a" data-v-2ed44237></path></svg></div> <div class="content" data-v-2ed44237><span class="tag" style="color:#00BCD4;" data-v-2ed44237>
            Redis
        </span></div></div></div> <div class="line" data-v-5d573f62></div> <div class="content" data-v-5d573f62><div class="content__default" data-v-5d573f62><h1 id="_1-nosql入门和概述"><a href="#_1-nosql入门和概述" class="header-anchor">#</a> 1. NoSql入门和概述</h1> <h2 id="_1-1-nosql数据库的四大分类"><a href="#_1-1-nosql数据库的四大分类" class="header-anchor">#</a> 1.1 NoSQL数据库的四大分类</h2> <ul><li><p>kv键值：</p> <p>​			典型介绍：  新浪：BerkeleyDB+redis</p> <p>​								 美团：redis+tair</p> <p>​								 阿里、百度：memcache+redis</p></li> <li><p>文档型数据库（bson格式比较多）：</p> <p>​								CouchDB</p> <p>​								MongoDB（为主）：是一个基于分布式文件存储的数据库。由C++语言编写，旨在为WEB应用提供可扩展的高性能数据存储解决方案。是																	  一个介于关系型数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。</p></li> <li><p>列存储数据库：</p> <p>​								Cassandra，HBase</p> <p>​								分布式文件系统</p></li> <li><p>图关系数据库：并不是放图形的，放的是关系。比如：朋友圈社交网络、广告推荐系统。专注于构建关系图谱</p> <p>​								Neo4J，InfoGrid</p></li></ul> <p>四者对比：</p> <p><img src="/blog/assets/img/image-20210413132428249.c6c3d3b8.png" alt="image-20210413132428249"></p> <h2 id="_1-2-分布式系统cap原理cap-base"><a href="#_1-2-分布式系统cap原理cap-base" class="header-anchor">#</a> 1.2 分布式系统CAP原理CAP+BASE</h2> <p><strong>RDBMS（Relational Databasae Management System：关系型数据库）的ACID</strong>：Atomicity（原子性）、Consistency（一致性）、Isolation（独立性）、Durability（持久性）</p> <p><strong>NoSQL的CAP</strong>：Consistency（强一致性）、Availability（可用性）、Partition tolerance（分区容错性）</p> <p><img src="/blog/assets/img/image-20210413133518095.b64884a5.png" alt="image-20210413133518095"></p> <p><img src="/blog/assets/img/image-20210413133610159.a4ad27af.png" alt="image-20210413133610159"></p> <h1 id="_2-redis数据类型"><a href="#_2-redis数据类型" class="header-anchor">#</a> 2. Redis数据类型</h1> <h2 id="_2-1-关于rediskey的基本命令"><a href="#_2-1-关于rediskey的基本命令" class="header-anchor">#</a> 2.1 关于RedisKey的基本命令</h2> <ul><li><p>keys *</p></li> <li><p>exists key：判断某个key是否存在</p></li> <li><p>move key db：当前库就没有了，被移动到db数据库中</p></li> <li><p>expire key：为给定的ley设置过期时间，秒钟</p></li> <li><p>ttl key：查看还有多少秒过期，-1表示永不过期，-2表示已过期</p></li> <li><p>type ley：查看key的类型</p> <p>补充： select index：选择数据库</p> <p>​			flushall：清空所有数据库</p> <p>​			flushdb：清空当前数据库</p></li></ul> <h2 id="_2-2-redis的五大数据类型"><a href="#_2-2-redis的五大数据类型" class="header-anchor">#</a> 2.2 Redis的五大数据类型</h2> <ul><li>String字符串：redis最基本的数据类型，其类型是二进制安全的，意思是redis的String可以包含任何数据。比如jpg图片或者序列化图像</li> <li>List列表：底层实际是链表</li> <li>Hash哈希：</li> <li>Set集合：无序集合，无重复，通过HashTable实现的。</li> <li>ZSet有序集合</li></ul> <h3 id="_2-1-1-redis字符串-string"><a href="#_2-1-1-redis字符串-string" class="header-anchor">#</a> 2.1.1 Redis字符串（String）</h3> <ul><li>set/get/ del/ append/ strlen</li> <li>incr/ decr/ incrby/ decrby，一定要是数字才能进行加减</li> <li>getrange/ setrange</li> <li>setex( set with expire ) / setnx( set if not exist )</li> <li>mset/ mget/ msetnx（事务特性）</li> <li>getset（先get再set）</li></ul> <h3 id="_2-1-2-redis列表-list"><a href="#_2-1-2-redis列表-list" class="header-anchor">#</a> 2.1.2 Redis列表（List）</h3> <p><strong>可重复</strong></p> <ul><li>lpush/rpush/lrange</li> <li>lpop/rpop</li> <li>lindex，按照索引下标获得元素</li> <li>llen</li> <li>lrem key，删除N个value</li> <li>ltrim key 开始index 结束index，截取指定范围的之后再复制给key</li> <li>rpoplpush 源列表 目的列表</li> <li>lset key index value</li> <li>linsert key before/after 值1 值2</li></ul> <h3 id="_2-1-3-redis集合-set"><a href="#_2-1-3-redis集合-set" class="header-anchor">#</a> 2.1.3 Redis集合（Set）</h3> <p><strong>不可重复，无序</strong></p> <ul><li>sadd/smembers/sismember</li> <li>scard，获取集合里面的元素个数</li> <li>srem key value 删除集合中元素</li> <li>srandmember key 某个整数（随机出几个数）</li> <li>spop key 随机出栈</li> <li>smove key1 key2 key1里某个值，作用是将key1里的某个值赋给key2</li> <li>数学集合类：差集sdiff，交集sinter，并集sunion</li></ul> <h3 id="_2-1-4-redis哈希-hash"><a href="#_2-1-4-redis哈希-hash" class="header-anchor">#</a> 2.1.4 Redis哈希（Hash）</h3> <p><strong>KV模式不变，但V是一个键值对</strong></p> <ul><li>hset/hget/hmset/hmget/hgetall/hdel</li> <li>hlen</li> <li>hexists key 在key里面的某个值的key</li> <li>hkeys/hvals</li> <li>hincrby/hincrbyfloat</li> <li>hsetnx</li></ul> <h3 id="_2-1-5-redis有序集合zset-sorted-set"><a href="#_2-1-5-redis有序集合zset-sorted-set" class="header-anchor">#</a> 2.1.5 Redis有序集合Zset（sorted set）</h3> <p><strong>在set基础上加一个score值。之前set是k1 v1 v2 v3，现在zset是k1 score1 v1  score2 v2</strong></p> <ul><li>zadd/zrange ... with score</li> <li>zrangebyscore key 开始score 结束score</li> <li>zrem key 某score下对应的value值，作用是删除元素</li> <li>zcard/zcount key score区间/zrank key values值，作用是获得下标值/zscore key 对应值，获得分数</li> <li>zrevrank key values值，作用是逆序获得下标值</li> <li>zrevrange</li> <li>zrevrangebyscore key 结束score 开始score</li></ul> <h2 id="_2-3-redis的三种特殊数据类型"><a href="#_2-3-redis的三种特殊数据类型" class="header-anchor">#</a> 2.3 Redis的三种特殊数据类型</h2> <h3 id="_2-3-1-geospatial-地理位置"><a href="#_2-3-1-geospatial-地理位置" class="header-anchor">#</a> 2.3.1 geospatial 地理位置</h3> <h3 id="_2-3-2-hyperloglog"><a href="#_2-3-2-hyperloglog" class="header-anchor">#</a> 2.3.2 hyperloglog</h3> <h3 id="_2-3-3-bitmaps"><a href="#_2-3-3-bitmaps" class="header-anchor">#</a> 2.3.3 bitmaps</h3> <h1 id="_3-事务"><a href="#_3-事务" class="header-anchor">#</a> 3. 事务</h1> <p>==要么同时成功，要么同时失败，原子性！ Redis的单条命令是保证原子性的，但是事务不保证！==</p> <p>Redis事务本质：一组命令的集合。一个事务中的所有命令都会被序列化，在事务执行过程中，会按照顺序一次性执行。且没有隔离级别的概念，所有的命令在事务中，并没有直接被执行，只有发起执行命令的时候才会执行！</p> <p>Redis事务</p> <ul><li><p>开启事务：multi</p></li> <li><p>命令入队</p></li> <li><p>执行事务：exec</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi
OK
<span class="token comment"># 命令入队</span>
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> k1 v1
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> k2 v2
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> get k2
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> k3 v3
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">exec</span>
<span class="token number">1</span><span class="token punctuation">)</span> OK
<span class="token number">2</span><span class="token punctuation">)</span> OK
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;v2&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> OK
</code></pre></div></li></ul> <p>取消事务：discard</p> <h1 id="_4-redis实现乐观锁"><a href="#_4-redis实现乐观锁" class="header-anchor">#</a> 4. Redis实现乐观锁</h1> <p><strong>悲观锁：很悲观，认为什么时候都会出现问题，无论做什么都会加锁</strong></p> <p><strong>乐观锁：很乐观，认为什么时候都不会出问题，所以不会上锁，更新数据的时候去判断一下，在此期间是否有人修改过这个数据（mybatispuls的学习中使用version字段，获取version，更新的时候比较version），Redis使用Watch来实现。</strong></p> <h2 id="redis监视测试"><a href="#redis监视测试" class="header-anchor">#</a> Redis监视测试</h2> <p>正常执行成功！</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> money <span class="token number">100</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> out <span class="token number">0</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token function">watch</span> money <span class="token comment">#监视money</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi
OK
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> decrby money <span class="token number">20</span>
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> incrby out <span class="token number">20</span>
QUEUED
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">(</span>TX<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">exec</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">80</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">20</span>
</code></pre></div><h1 id="_5-springboot集成redis-自定义redistributiontemplate"><a href="#_5-springboot集成redis-自定义redistributiontemplate" class="header-anchor">#</a> 5. SpringBoot集成Redis，自定义RedistributionTemplate</h1> <p>导入依赖：</p> <div class="language-xml extra-class"><pre class="language-xml"><code>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>编写RedisConfig配置类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GenericJackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        template<span class="token punctuation">.</span><span class="token function">setHashKeySerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setHashValueSerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GenericJackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> template<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>application.yml：</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> 192.168.48.130
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">6379</span>
</code></pre></div><p>测试：</p> <div class="language- extra-class"><pre class="language-text"><code>@SpringBootTest
class RedisStudyApplicationTests {

    @Autowired
    @Qualifier(&quot;redisTemplate&quot;)
    RedisTemplate redisTemplate;

    @Test
    void contextLoads() {
        redisTemplate.opsForValue().
                set(&quot;name2&quot;, &quot;张三&quot;);
        System.out.println(redisTemplate.opsForValue().get(&quot;name2&quot;));

    }

}
</code></pre></div><p>==SpringBoot连接本地虚拟机上的Reids时，要在虚拟机上开启RedisServer。当Java程序报错时，在虚拟机上设置防火请的6379端口打开即可。==</p> <h1 id="_6-redis持久化"><a href="#_6-redis持久化" class="header-anchor">#</a> 6. Redis持久化</h1> <p><strong>Redis是一个内存数据库，数据保存在内存中，但是我们都知道内存的数据变化是很快的，也容易发生丢失。幸好Redis还为我们提供了持久化的机制，分别是RDB(Redis DataBase)和AOF(Append Only File)。</strong></p> <p>参考：https://baijiahao.baidu.com/s?id=1654694618189745916&amp;wfr=spider&amp;for=pc</p></div></div> <div class="footer" data-v-5d573f62><div title="share this post" class="share share-icon" data-v-5d573f62><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-share-2" data-v-5d573f62><circle cx="18" cy="5" r="3" data-v-5d573f62></circle><circle cx="6" cy="12" r="3" data-v-5d573f62></circle><circle cx="18" cy="19" r="3" data-v-5d573f62></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49" data-v-5d573f62></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49" data-v-5d573f62></line></svg> <path d="M896 469.333333l-298.666667-298.666667 0 170.666667C298.666667 384 170.666667 597.333333 128 810.666667c106.666667-149.333333 256-217.6 469.333333-217.6L597.333333 768 896 469.333333z" p-id="7022" fill="#1296db" data-v-5d573f62></path></div> <div class="share" data-v-5d573f62><!----></div> <div class="share" data-v-5d573f62><!----></div></div></div> <div class="footer" data-v-882df4f6 data-v-5d573f62><footer data-v-882df4f6><div data-v-882df4f6>
            © 2018 -
            2022
            <svg viewBox="64 64 896 896" data-icon="flag" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" data-v-882df4f6><path fill="#1296db" d="M880 305H624V192c0-17.7-14.3-32-32-32H184v-40c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v784c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V640h248v113c0 17.7 14.3 32 32 32h416c17.7 0 32-14.3 32-32V337c0-17.7-14.3-32-32-32z" data-v-882df4f6></path></svg>
            @Yuan YE
        </div> <div data-v-882df4f6>
            Based on the
            <a href="https://vuepress.vuejs.org/" target="_blank" data-v-882df4f6>VuePress Powered</a>
            &amp;
            <a href="https://github.com/korilin/vuepress-theme-twipress" target="_blank" data-v-882df4f6>Twipress Theme</a></div> <div data-v-882df4f6>
            备案号：<a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/" data-v-882df4f6>
                粤ICP备19149652号
            </a></div></footer></div></div></div><div id="toolbar" data-v-fe84d7a0><!----> <div class="toolbar" data-v-fe84d7a0><div class="search" data-v-fe84d7a0><div class="search-box" data-v-fe84d7a0><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="post-sort" data-v-fe84d7a0><div class="title" data-v-fe84d7a0>Post Order</div> <div class="op" data-v-fe84d7a0>
                By Time
                <svg t="1610607067172" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2795" width="20" height="20" class="icon" style="display:;" data-v-fe84d7a0><path d="M495.765247 353.091804 333.414649 190.741205 171.065074 353.091804 304.386522 353.091804l0 420.142919c0 17.947767 14.046924 32.469506 31.978319 32.469506 17.931395 0 31.978319-14.522762 31.978319-32.469506L368.343159 353.091804 495.765247 353.091804z" p-id="2796" data-v-fe84d7a0></path> <path d="M720.104665 672.874991 720.104665 221.24494c0-17.947767-14.046924-32.469506-31.978319-32.469506s-31.978319 14.522762-31.978319 32.469506l0 451.630051-127.913275 0 162.349575 162.349575 162.349575-162.349575L720.104665 672.874991z" p-id="2797" data-spm-anchor-id="a313x.7781069.0.i7" fill="#1296db" class="selected" data-v-fe84d7a0></path></svg> <svg t="1610612746140" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2973" width="20" height="20" class="icon" style="display:none;" data-v-fe84d7a0><path d="M495.765247 353.091804 333.414649 190.741205 171.065074 353.091804 304.386522 353.091804l0 420.142919c0 17.947767 14.046924 32.469506 31.978319 32.469506 17.931395 0 31.978319-14.522762 31.978319-32.469506L368.343159 353.091804 495.765247 353.091804z" p-id="2974" data-spm-anchor-id="a313x.7781069.0.i9" fill="#1296db" class="selected" data-v-fe84d7a0></path> <path d="M720.104665 672.874991 720.104665 221.24494c0-17.947767-14.046924-32.469506-31.978319-32.469506s-31.978319 14.522762-31.978319 32.469506l0 451.630051-127.913275 0 162.349575 162.349575 162.349575-162.349575L720.104665 672.874991z" p-id="2975" data-v-fe84d7a0></path></svg>
                :
                <span class="content" data-v-fe84d7a0>DESC</span></div></div> <div class="statistics" data-v-fe84d7a0><div class="title" data-v-fe84d7a0>Article Statistics</div> <div class="data" data-v-fe84d7a0>
                Article: 27
            </div> <div class="data" data-v-fe84d7a0>
                Categories: 5
            </div> <div class="data" data-v-fe84d7a0>
                Tags: 18
            </div> <div class="more" data-v-fe84d7a0><a href="/blog/archive" data-v-fe84d7a0>see more</a></div></div></div></div></span></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.3aaa0c49.js" defer></script><script src="/blog/assets/js/11.05829631.js" defer></script>
  </body>
</html>
