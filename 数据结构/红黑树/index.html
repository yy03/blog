<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>红黑树 | YuanYE</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/blog/logo.png">
    <meta name="description" content="Kori Lin BLOG">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" conetent="KORILIN">
    <meta name="twitter:creator" conetent="@Kori_Lin">
    
    <link rel="preload" href="/blog/assets/css/1.styles.1f37ec6d.css" as="style"><link rel="preload" href="/blog/assets/js/app.3aaa0c49.js" as="script"><link rel="preload" href="/blog/assets/js/5.cb45b255.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.73419e87.js"><link rel="prefetch" href="/blog/assets/js/11.05829631.js"><link rel="prefetch" href="/blog/assets/js/12.7e8086c5.js"><link rel="prefetch" href="/blog/assets/js/13.f1400667.js"><link rel="prefetch" href="/blog/assets/js/14.c6dd0951.js"><link rel="prefetch" href="/blog/assets/js/15.0f37c6f6.js"><link rel="prefetch" href="/blog/assets/js/16.a4662ec0.js"><link rel="prefetch" href="/blog/assets/js/17.e8372a64.js"><link rel="prefetch" href="/blog/assets/js/18.37715e79.js"><link rel="prefetch" href="/blog/assets/js/19.e397b51f.js"><link rel="prefetch" href="/blog/assets/js/2.1e961ff5.js"><link rel="prefetch" href="/blog/assets/js/20.19f61b49.js"><link rel="prefetch" href="/blog/assets/js/21.3b043514.js"><link rel="prefetch" href="/blog/assets/js/22.60b4227d.js"><link rel="prefetch" href="/blog/assets/js/23.0dbcd6f8.js"><link rel="prefetch" href="/blog/assets/js/24.b5bb6a2c.js"><link rel="prefetch" href="/blog/assets/js/25.f36cd997.js"><link rel="prefetch" href="/blog/assets/js/26.2173183c.js"><link rel="prefetch" href="/blog/assets/js/27.7e05cc7c.js"><link rel="prefetch" href="/blog/assets/js/28.bcba955e.js"><link rel="prefetch" href="/blog/assets/js/29.f0b4c45b.js"><link rel="prefetch" href="/blog/assets/js/3.58551e39.js"><link rel="prefetch" href="/blog/assets/js/30.04c3ed65.js"><link rel="prefetch" href="/blog/assets/js/4.bf1654a3.js"><link rel="prefetch" href="/blog/assets/js/6.aa9fd703.js"><link rel="prefetch" href="/blog/assets/js/7.a807b0d2.js"><link rel="prefetch" href="/blog/assets/js/8.29c46423.js"><link rel="prefetch" href="/blog/assets/js/9.58f55c6f.js">
    <link rel="stylesheet" href="/blog/assets/css/1.styles.1f37ec6d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><span><div id="sidebar" data-v-6e67c360><div class="PC-sidebar" data-v-6e67c360><div class="title" data-v-6e67c360>
            @<span data-v-6e67c360>YuanYE</span></div> <a href="/blog/" class="router-link-active bar-button" data-v-7201a518 data-v-6e67c360><div class="svg" data-v-7201a518><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home" data-v-7201a518><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" data-v-7201a518></path> <polyline points="9 22 9 12 15 12 15 22" data-v-7201a518></polyline></svg> <!----> <!----></div> <div class="name" data-v-7201a518>Home</div></a> <a href="/blog/archive" class="bar-button" data-v-7201a518 data-v-6e67c360><div class="svg" data-v-7201a518><!----> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-book" data-v-7201a518><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" data-v-7201a518></path> <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" data-v-7201a518></path></svg> <!----></div> <div class="name" data-v-7201a518>Archive</div></a> <a href="/blog/about/" class="bar-button" data-v-7201a518 data-v-6e67c360><div class="svg" data-v-7201a518><!----> <!----> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user" data-v-7201a518><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" data-v-7201a518></path> <circle cx="12" cy="7" r="4" data-v-7201a518></circle></svg></div> <div class="name" data-v-7201a518>About</div></a></div> <!----></div><div class="main"><div class="wrap" data-v-5d573f62><div class="post" data-v-5d573f62><div class="title" data-v-5d573f62><h1 data-v-5d573f62>红黑树</h1></div> <div class="info" data-v-5d573f62><div class="date" data-v-382026d3 data-v-5d573f62><div class="svg" data-v-382026d3><svg t="1610177893433" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5858" width="16" height="16" class="icon" data-v-382026d3><path d="M512 192c179.2 0 320 140.8 320 320s-140.8 320-320 320-320-140.8-320-320S332.8 192 512 192M512 128C300.8 128 128 300.8 128 512s172.8 384 384 384 384-172.8 384-384S723.2 128 512 128L512 128z" p-id="5859" fill="#707070" data-v-382026d3></path> <path d="M640 672c-6.4 0-19.2 0-25.6-6.4l-128-128C486.4 531.2 480 518.4 480 512L480 288C480 268.8 492.8 256 512 256s32 12.8 32 32l0 211.2 121.6 121.6c12.8 12.8 12.8 32 0 44.8C659.2 672 646.4 672 640 672z" p-id="5860" fill="#707070" data-v-382026d3></path></svg></div> <div class="content" data-v-382026d3>2020-11-19</div></div> <div class="category" data-v-a6fce850 data-v-5d573f62><div class="svg" data-v-a6fce850><svg t="1610177808699" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4460" width="16" height="16" class="icon" data-v-a6fce850><path d="M725.290667 725.290667m-213.333334 0a213.333333 213.333333 0 1 0 426.666667 0 213.333333 213.333333 0 1 0-426.666667 0Z" p-id="4461" fill="#707070" data-v-a6fce850></path> <path d="M789.205333 234.794667m-149.333333 0a149.333333 149.333333 0 1 0 298.666667 0 149.333333 149.333333 0 1 0-298.666667 0Z" p-id="4462" fill="#707070" data-v-a6fce850></path> <path d="M235.861333 788.138667m-149.333333 0a149.333333 149.333333 0 1 0 298.666667 0 149.333333 149.333333 0 1 0-298.666667 0Z" p-id="4463" fill="#707070" data-v-a6fce850></path> <path d="M298.709333 298.709333m-213.333333 0a213.333333 213.333333 0 1 0 426.666667 0 213.333333 213.333333 0 1 0-426.666667 0Z" p-id="4464" fill="#707070" data-v-a6fce850></path></svg></div> <div class="content" data-v-a6fce850>数据结构</div></div> <div class="tags" data-v-2ed44237 data-v-5d573f62><div class="svg" data-v-2ed44237><svg t="1610177743508" viewBox="0 0 1085 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2934" width="16" height="16" class="icon" data-v-2ed44237><path d="M256 256q0-30.285714-21.428571-51.714286T182.857143 182.857143t-51.714286 21.428571T109.714286 256t21.428571 51.714286T182.857143 329.142857t51.714286-21.428571T256 256z m609.714286 329.142857q0 30.285714-21.142857 51.428572l-280.571429 281.142857q-22.285714 21.142857-52 21.142857-30.285714 0-51.428571-21.142857L52 508.571429q-21.714286-21.142857-36.857143-57.714286T0 384V146.285714q0-29.714286 21.714286-51.428571t51.428571-21.714286h237.714286q30.285714 0 66.857143 15.142857T436 125.142857l408.571429 408q21.142857 22.285714 21.142857 52z m219.428571 0q0 30.285714-21.142857 51.428572l-280.571429 281.142857q-22.285714 21.142857-52 21.142857-20.571429 0-33.714285-8t-30.285715-25.714286l268.571429-268.571428q21.142857-21.142857 21.142857-51.428572 0-29.714286-21.142857-52L527.428571 125.142857q-21.714286-21.714286-58.285714-36.857143T402.285714 73.142857h128q30.285714 0 66.857143 15.142857t58.285714 36.857143l408.571429 408q21.142857 22.285714 21.142857 52z" p-id="2935" fill="#8a8a8a" data-v-2ed44237></path></svg></div> <div class="content" data-v-2ed44237><span class="tag" style="color:#00BCD4;" data-v-2ed44237>
            红黑树
        </span></div></div></div> <div class="line" data-v-5d573f62></div> <div class="content" data-v-5d573f62><div class="content__default" data-v-5d573f62><h1 id="_1-红黑树"><a href="#_1-红黑树" class="header-anchor">#</a> 1. 红黑树</h1> <p><strong>本次实现的红黑树是基于2-3查找树的，不涉及4-结点，且是2-3树中较为特殊的一种转化——左倾红黑树，红色结点必须是左儿子，红色结点理解为该结点为红色或者指向本结点的链接为红色都可以</strong></p> <p>红黑树主要是对2-3树进行编码实现，红黑树背后的基本思想是用标准的二叉查找树（完全由2-结点构成）和一些额外的信息（替换3-结点）来表示2-3树，我们将树中的链接分为两种类型：</p> <ul><li>**红链接：**将两个2-结点连接起来构成一个3-结点</li> <li>**黑链接：**2-3树中的普通链接</li></ul> <p><img src="/blog/assets/img/image-20210510202240318.832aba34.png" alt="image-20210510202240318"></p> <h2 id="_1-1-红黑树的定义"><a href="#_1-1-红黑树的定义" class="header-anchor">#</a> 1.1 红黑树的定义</h2> <p>红黑树是含有红黑链接并满足下列条件的二叉查找树：</p> <ul><li>红色链接均为左连接</li> <li>没有任何一个结点同时和两条红链接相连</li> <li>根节点是黑色</li> <li>该树是完美黑色平衡的，即任意空链接到根节点的路径上的黑色链接数量相同（即黑高）</li></ul> <p><strong>之后的左旋调整、右旋调整、颜色反转都是为了满足红黑树的定义。</strong></p> <h2 id="_1-2-平衡化"><a href="#_1-2-平衡化" class="header-anchor">#</a> 1.2 平衡化</h2> <p>在对红黑树进行一些增删改的操作后，很有可能会出现红色的右链接或者两条连续红色的链接，而这些都不满足红黑树的定义，所以我们需要对这些情况通过旋转进行修复，让红黑树保持平衡。<a href="https://blog.csdn.net/qq_44322357/article/details/90416151?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162065556116780271558457%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=162065556116780271558457&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-90416151.pc_search_result_before_js&amp;utm_term=LL+RR+LR+RL" target="_blank" rel="noopener noreferrer">参考平衡二叉树的平衡化<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_1-2-1-左旋调整"><a href="#_1-2-1-左旋调整" class="header-anchor">#</a> 1.2.1 左旋调整</h3> <p>当某个结点的左子结点是红色，且左子节点的左子节点也是红色，需要左旋调整</p> <p>**前提：**当前结点为h，它的左子结点为x；（结点x绕h）</p> <p><strong>左旋过程：</strong></p> <div class="language- extra-class"><pre><code>1. 让x的右子节点成为h的左子节点
2. 让h成为x的右子节点
3. 让x的color变为h的color属性值：x.color = h.color
4. 让h的color变为RED
</code></pre></div><p><strong>注意：此时完成左旋调整后仍不满足红黑树的定义（x的右子节点为红色），现在先不要管，后续会进行颜色的反转使其满足定义，现在讲的只是如何进行左旋调整。</strong></p> <p><img src="/blog/assets/img/image-20210510221736742.8ce07263.png" alt="image-20210510221736742"></p> <h3 id="_1-2-2-右旋调整"><a href="#_1-2-2-右旋调整" class="header-anchor">#</a> 1.2.2 右旋调整</h3> <p>当某个结点的左子结点为黑色，右子节点为红色，需要进行右旋调整。</p> <p>**前提：**当前结点为h，它的右子节点为x；（x结点绕结点h进行右旋）</p> <p><strong>右旋过程：</strong></p> <div class="language- extra-class"><pre><code>1. 让x的左子节点成为h的右子节点
2. 让h成为x的左子节点
3. 让x的color属性值变为h的color属性值：x.color = h.color
4. 让h的color属性值变为RED：h.color = true
</code></pre></div><p><img src="/blog/assets/img/image-20210510221835196.971cea8d.png" alt="image-20210510221835196"></p> <h1 id="_1-3-颜色反转"><a href="#_1-3-颜色反转" class="header-anchor">#</a> 1.3 颜色反转</h1> <p>当一个结点的左子结点和右子结点的color都为RED时，也就是出现了4-结点，由于本次实现的是基于2-3树实现的红黑树，是不包含4-结点的，所以需要进行颜色反转，将4-结点分解，此时只需要把左子结点和右子结点的颜色变为BLACK，同时让当前结点的颜色变为RED即可（根结点为黑色）</p> <p><img src="/blog/assets/img/image-20210510213740566.e0876a23.png" alt="image-20210510213740566"></p> <h2 id="_1-4-插入"><a href="#_1-4-插入" class="header-anchor">#</a> 1.4 插入</h2> <p>红黑树的插入是一个比较复杂的过程，重点！！</p> <h3 id="_1-4-1-向单个2-结点中插入新键"><a href="#_1-4-1-向单个2-结点中插入新键" class="header-anchor">#</a> 1.4.1 向单个2-结点中插入新键</h3> <p>如果红黑树只含有一个2-结点，插入后，我们马上就需要将他们旋转</p> <ul><li><p>如果新键小于当前结点，我们只需要新增一个红色结点即可，新的红黑树和单个3-结点完全等价。</p> <p><img src="/blog/assets/img/image-20210510210401605.46fb5fb5.png" alt="image-20210510210401605"></p></li> <li><p>如果新键大于当前结点的键，那么新增的红色结点将会产生一条红色的右链接，此时我们需要通过左旋，把红色右链接变成左链接，插入操作才算完成。形成的新红黑树依然和3-结点等价且满足定义。</p> <p><img src="/blog/assets/img/image-20210510222324948.c13275ba.png" alt="image-20210510222324948"></p></li></ul> <h3 id="_1-4-2-向底部的2结点插入新键"><a href="#_1-4-2-向底部的2结点插入新键" class="header-anchor">#</a> 1.4.2 向底部的2结点插入新键</h3> <p>用和二叉查找树相同的方式向一颗红黑树中插入一个新键，会在树的底部新增一个结点（可以保证有序性），唯一的区别是我们会用红链接将新节点和它的父节点相连。如果它的父节点是一个2-结点，那么刚才讨论的两种方式任然使用。</p> <p><img src="/blog/assets/img/image-20210510222415980.67362404.png" alt="image-20210510222415980"></p> <h3 id="_1-4-3-向3-结点中插入新键"><a href="#_1-4-3-向3-结点中插入新键" class="header-anchor">#</a> 1.4.3 向3-结点中插入新键</h3> <p>这种情况又可以分为三种子情况：</p> <ol><li><p>新键大于原树中的两个键</p> <p><img src="/blog/assets/img/image-20210510215452404.254d78e0.png" alt="image-20210510215452404"></p> <ol start="2"><li>新键小于原树中的两个键</li></ol> <p><img src="/blog/assets/img/image-20210510222442766.244b0e4f.png" alt="image-20210510222442766"></p> <ol start="3"><li>新键介于原树中的两个键之间</li></ol> <p><img src="/blog/assets/img/image-20210510222521373.5645f772.png" alt="image-20210510222521373"></p></li></ol> <h3 id="_1-4-4-向树底部的3-结点插入新键"><a href="#_1-4-4-向树底部的3-结点插入新键" class="header-anchor">#</a> 1.4.4 向树底部的3-结点插入新键</h3> <p>假设在树的底部的一个3-结点下加入一个新的结点。前面我们所讲的3种情况都会出现。指向新节点的链接可能是3-结点的右链接（此时我们只需要转换颜色即可），或是左链接（此时我们需要进行左旋转再进行颜色反转），或是中链接（此时需要先进行右旋转然后再左旋转，最后进行颜色反转）。颜色转换会使中间结点的颜色变红，相当于将它送入了父结点。这意味着父结点中继续插入一个新键，我们只需要使用相同的方法解决即可，直到遇到一个2-结点或者根结点为止。</p> <h1 id="_2-红黑树的实现"><a href="#_2-红黑树的实现" class="header-anchor">#</a> 2. 红黑树的实现</h1> <h2 id="_2-1-红黑树结点的api设计"><a href="#_2-1-红黑树结点的api设计" class="header-anchor">#</a> 2.1 红黑树结点的API设计</h2> <table><thead><tr><th>类名</th> <th>Node&lt;Key, Value&gt;</th></tr></thead> <tbody><tr><td>构造方法</td> <td>Node(Key key, Value value, Node left, Node right, boolean color)：创建Node对象</td></tr> <tr><td>成员变量</td> <td>1. public Node left：记录左子节点<br>2. public Node right：记录右子节点<br>3. public Key key：存储键<br>4. public Value value：存储值<br>5. public boolean color：该结点颜色</td></tr></tbody></table> <h2 id="_2-2-红黑树的api设计"><a href="#_2-2-红黑树的api设计" class="header-anchor">#</a> 2.2 红黑树的API设计</h2> <table><thead><tr><th>类名</th> <th>RedBlackTree&lt;Key extends Comparable<Key>, Value&gt;</Key></th></tr></thead> <tbody><tr><td>构造方法</td> <td>RedBlackTree()：创建RedBlackTree对象</td></tr> <tr><td>成员方法</td> <td>1. public void put(Key key, Value val)：在整个树中完成插入操作<br>2. public Value  get(Key key)：根据key，在树中找出对应的值<br>3. public int size()：获取树中元素的个数<br>4. private Node put(Node h, Key key, Value val)：在指定的树完成插入操作 ，并返回添加元素后的新树<br>5. private Value get(Node x, Key key)：从指定的树x中，找出key对应的值<br>6. private boolean isRed(Node x)：判断当前结点是否为红色<br>7. private Node rotateLeft(Node h)：左旋调整<br>8. private Node rotateRight(Node h)：右旋调整<br>9. private void flipColors(Node h)：颜色反转，相当于完成拆分4-结点</td></tr> <tr><td>成员变量</td> <td>1. private Node root：记录根节点<br>2. private int N：记录树中元素的个数<br>3. private static final boolean RED：红色标识<br>4. private static final boolean BLACK：黑色标识</td></tr></tbody></table> <p><strong>实现（无删除）：</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">tree</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedBlackTree</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Key</span> <span class="token keyword">extends</span> <span class="token class-name">Comparable</span><span class="token punctuation">&lt;</span><span class="token class-name">Key</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Value</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">Node</span> root<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token class-name">N</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> RED <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> BLACK <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Key</span><span class="token punctuation">,</span> <span class="token class-name">Value</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token class-name">Key</span> key<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token class-name">Value</span> value<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token class-name">Node</span> left<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token class-name">Node</span> right<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">boolean</span> color<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token class-name">Key</span> key<span class="token punctuation">,</span> <span class="token class-name">Value</span> value<span class="token punctuation">,</span> <span class="token class-name">Node</span> left<span class="token punctuation">,</span> <span class="token class-name">Node</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>left <span class="token operator">=</span> left<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>right <span class="token operator">=</span> right<span class="token punctuation">;</span>
<span class="token comment">//            默认红色</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> RED<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">N</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 根据key在树中找出对应的值
     *
     * @param key
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Node</span> <span class="token function">getNode</span><span class="token punctuation">(</span><span class="token class-name">Key</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getNode</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 向树中插入
     *
     * @param key
     * @param value
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Key</span> key<span class="token punctuation">,</span> <span class="token class-name">Value</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        root <span class="token operator">=</span> <span class="token function">put</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        root<span class="token punctuation">.</span>color <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 在指定树中根据key查找
     *
     * @param x
     * @param key
     * @return
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Node</span> <span class="token function">getNode</span><span class="token punctuation">(</span><span class="token class-name">Node</span> x<span class="token punctuation">,</span> <span class="token class-name">Key</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Key</span><span class="token punctuation">)</span> x<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">getNode</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>right<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">getNode</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>left<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> x<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 向指定树中插入，完成后返回新树
     *
     * @param h
     * @param key
     * @param value
     * @return
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Node</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Node</span> h<span class="token punctuation">,</span> <span class="token class-name">Key</span> key<span class="token punctuation">,</span> <span class="token class-name">Value</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>h <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">N</span><span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Key</span><span class="token punctuation">)</span> h<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//            继续往右</span>
            h<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token function">put</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>right<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//            继续往左</span>
            h<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token function">put</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>left<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
<span class="token comment">//            值替换</span>
            h<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token comment">//        进行左旋：若当前结点h的</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isRed</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isRed</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>left<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            h <span class="token operator">=</span> <span class="token function">rotateLeft</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token comment">//        进行右旋：若当前结点h的左子结点为黑色，右子结点为红色，则右子结点需要绕h结点进行右旋</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isRed</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>right<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isRed</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            h <span class="token operator">=</span> <span class="token function">rotateRight</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token comment">//        进行颜色反转</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isRed</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isRed</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">flipColor</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> h<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">isRed</span><span class="token punctuation">(</span><span class="token class-name">Node</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> x <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> x<span class="token punctuation">.</span>color <span class="token operator">==</span> RED<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 左旋
     *
     * @param h
     * @return
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Node</span> <span class="token function">rotateLeft</span><span class="token punctuation">(</span><span class="token class-name">Node</span> h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Node</span> left <span class="token operator">=</span> h<span class="token punctuation">.</span>left<span class="token punctuation">;</span>
        h<span class="token punctuation">.</span>left <span class="token operator">=</span> left<span class="token punctuation">.</span>right<span class="token punctuation">;</span>
        left<span class="token punctuation">.</span>right <span class="token operator">=</span> h<span class="token punctuation">;</span>

        left<span class="token punctuation">.</span>color <span class="token operator">=</span> h<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
        h<span class="token punctuation">.</span>color <span class="token operator">=</span> RED<span class="token punctuation">;</span>
        <span class="token keyword">return</span> left<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 右旋
     *
     * @param h
     * @return
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Node</span> <span class="token function">rotateRight</span><span class="token punctuation">(</span><span class="token class-name">Node</span> h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Node</span> right <span class="token operator">=</span> h<span class="token punctuation">.</span>right<span class="token punctuation">;</span>

        h<span class="token punctuation">.</span>right <span class="token operator">=</span> right<span class="token punctuation">.</span>left<span class="token punctuation">;</span>
        right<span class="token punctuation">.</span>left <span class="token operator">=</span> h<span class="token punctuation">;</span>
        right<span class="token punctuation">.</span>color <span class="token operator">=</span> h<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
        h<span class="token punctuation">.</span>color <span class="token operator">=</span> RED<span class="token punctuation">;</span>
        <span class="token keyword">return</span> right<span class="token punctuation">;</span> <span class="token comment">//注意此时返回的是right</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 颜色反转
     *
     * @param h
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">flipColor</span><span class="token punctuation">(</span><span class="token class-name">Node</span> h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//        当前结点变为红色</span>
        h<span class="token punctuation">.</span>color <span class="token operator">=</span> RED<span class="token punctuation">;</span>
<span class="token comment">//        左、右变为黑色</span>
        h<span class="token punctuation">.</span>left<span class="token punctuation">.</span>color <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
        h<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div></div></div> <div class="footer" data-v-5d573f62><div title="share this post" class="share share-icon" data-v-5d573f62><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-share-2" data-v-5d573f62><circle cx="18" cy="5" r="3" data-v-5d573f62></circle><circle cx="6" cy="12" r="3" data-v-5d573f62></circle><circle cx="18" cy="19" r="3" data-v-5d573f62></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49" data-v-5d573f62></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49" data-v-5d573f62></line></svg> <path d="M896 469.333333l-298.666667-298.666667 0 170.666667C298.666667 384 170.666667 597.333333 128 810.666667c106.666667-149.333333 256-217.6 469.333333-217.6L597.333333 768 896 469.333333z" p-id="7022" fill="#1296db" data-v-5d573f62></path></div> <div class="share" data-v-5d573f62><!----></div> <div class="share" data-v-5d573f62><!----></div></div></div> <div class="footer" data-v-882df4f6 data-v-5d573f62><footer data-v-882df4f6><div data-v-882df4f6>
            © 2018 -
            2022
            <svg viewBox="64 64 896 896" data-icon="flag" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" data-v-882df4f6><path fill="#1296db" d="M880 305H624V192c0-17.7-14.3-32-32-32H184v-40c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v784c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V640h248v113c0 17.7 14.3 32 32 32h416c17.7 0 32-14.3 32-32V337c0-17.7-14.3-32-32-32z" data-v-882df4f6></path></svg>
            @Yuan YE
        </div> <div data-v-882df4f6>
            Based on the
            <a href="https://vuepress.vuejs.org/" target="_blank" data-v-882df4f6>VuePress Powered</a>
            &amp;
            <a href="https://github.com/korilin/vuepress-theme-twipress" target="_blank" data-v-882df4f6>Twipress Theme</a></div> <div data-v-882df4f6>
            备案号：<a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/" data-v-882df4f6>
                粤ICP备19149652号
            </a></div></footer></div></div></div><div id="toolbar" data-v-fe84d7a0><!----> <div class="toolbar" data-v-fe84d7a0><div class="search" data-v-fe84d7a0><div class="search-box" data-v-fe84d7a0><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="post-sort" data-v-fe84d7a0><div class="title" data-v-fe84d7a0>Post Order</div> <div class="op" data-v-fe84d7a0>
                By Time
                <svg t="1610607067172" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2795" width="20" height="20" class="icon" style="display:;" data-v-fe84d7a0><path d="M495.765247 353.091804 333.414649 190.741205 171.065074 353.091804 304.386522 353.091804l0 420.142919c0 17.947767 14.046924 32.469506 31.978319 32.469506 17.931395 0 31.978319-14.522762 31.978319-32.469506L368.343159 353.091804 495.765247 353.091804z" p-id="2796" data-v-fe84d7a0></path> <path d="M720.104665 672.874991 720.104665 221.24494c0-17.947767-14.046924-32.469506-31.978319-32.469506s-31.978319 14.522762-31.978319 32.469506l0 451.630051-127.913275 0 162.349575 162.349575 162.349575-162.349575L720.104665 672.874991z" p-id="2797" data-spm-anchor-id="a313x.7781069.0.i7" fill="#1296db" class="selected" data-v-fe84d7a0></path></svg> <svg t="1610612746140" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2973" width="20" height="20" class="icon" style="display:none;" data-v-fe84d7a0><path d="M495.765247 353.091804 333.414649 190.741205 171.065074 353.091804 304.386522 353.091804l0 420.142919c0 17.947767 14.046924 32.469506 31.978319 32.469506 17.931395 0 31.978319-14.522762 31.978319-32.469506L368.343159 353.091804 495.765247 353.091804z" p-id="2974" data-spm-anchor-id="a313x.7781069.0.i9" fill="#1296db" class="selected" data-v-fe84d7a0></path> <path d="M720.104665 672.874991 720.104665 221.24494c0-17.947767-14.046924-32.469506-31.978319-32.469506s-31.978319 14.522762-31.978319 32.469506l0 451.630051-127.913275 0 162.349575 162.349575 162.349575-162.349575L720.104665 672.874991z" p-id="2975" data-v-fe84d7a0></path></svg>
                :
                <span class="content" data-v-fe84d7a0>DESC</span></div></div> <div class="statistics" data-v-fe84d7a0><div class="title" data-v-fe84d7a0>Article Statistics</div> <div class="data" data-v-fe84d7a0>
                Article: 27
            </div> <div class="data" data-v-fe84d7a0>
                Categories: 5
            </div> <div class="data" data-v-fe84d7a0>
                Tags: 18
            </div> <div class="more" data-v-fe84d7a0><a href="/blog/archive" data-v-fe84d7a0>see more</a></div></div></div></div></span></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.3aaa0c49.js" defer></script><script src="/blog/assets/js/5.cb45b255.js" defer></script>
  </body>
</html>
